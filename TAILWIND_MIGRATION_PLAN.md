# План миграции на Tailwind CSS с адаптивным дизайном

## Общая информация

**Цель**: Полностью перейти на Tailwind CSS, убрать custom CSS файлы, сделать сайт адаптивным для мобильных устройств.

**Особые требования**:
- Страница `detail.html` должна оставаться фиксированной ширины (для корректного отображения таблиц)
- Все остальные страницы должны быть адаптивными (mobile-first подход)
- Использовать Tailwind CDN уже подключен в `base.html`

**Текущее состояние**:
- 7 кастомных CSS файлов в `/static/css/`
- Часть шаблонов уже использует Tailwind классы
- Смешанный подход: Tailwind + custom CSS

---

## Фаза 1: Подготовка и настройка инфраструктуры ✅

### 1.1 Настройка Tailwind Config ✅
- [x] Создать `tailwind.config.js` с custom цветовой схемой из `site.css` ✅
- [x] Добавить все кастомные цвета в палитру Tailwind ✅
  - `--bg: #0b0b0b` → `bg-dark-900` ✅
  - `--panel: #141414` → `bg-dark-800` ✅
  - `--panel-2: #1a1a1a` → `bg-dark-700` ✅
  - `--accent: #c0392b` → `bg-accent-500` ✅
  - `--accent-2: #e74c3c` → `bg-accent-600` ✅
  - `--gold: #f7c76b` → `text-gold` ✅
- [x] Настроить breakpoints для адаптивности ✅
  ```js
  screens: {
    'xs': '480px',
    'sm': '640px',
    'md': '768px',
    'lg': '1024px',
    'xl': '1280px',
    '2xl': '1600px'
  }
  ```
- [x] Добавить кастомные border-radius и box-shadow ✅

### 1.2 Переход с CDN на локальную сборку ✅
- [x] Установить Tailwind CLI: `npm install -D tailwindcss` ✅
- [x] Создать `input.css` с директивами `@tailwind` ✅
- [x] Настроить npm-скрипты для билда CSS ✅
- [x] Добавить `.gitignore` для `node_modules/` и скомпилированного CSS ✅
- [x] Создать продакшн-версию с минификацией ✅

---

## Фаза 2: Миграция базовых компонентов ✅ (8/8 завершено)

### 2.1 Base Layout (`templates/base.html`) ✅
**Текущий статус**: Мигрирован на Tailwind

- [ ] Убрать подключение `site.css` (временно оставлен для постепенной миграции)
- [x] Убрать подключение `sidebar.css` ✅
- [x] Убрать подключение `dev_banner.css` ✅
- [x] Убрать подключение `alert_modal.css` ✅
- [x] Добавлен `output.css` (Tailwind) ✅
- [x] Проверена адаптивность структуры контейнеров ✅
- [x] Добавлены responsive breakpoints для `.container-center` ✅
- [ ] Проверить работу на мобильных устройствах (требуется тестирование)

**CSS для удаления**:
- `static/css/site.css` (временно оставлен для постепенной миграции)

---

### 2.2 Navbar (`templates/includes/_navbar.html`) ✅
**Текущий статус**: Мигрирован на Tailwind

- [x] Проверена базовая структура ✅
- [ ] Добавить hamburger menu для мобильных устройств (TODO)
- [x] Убраны CSS переменные, заменены на Tailwind классы ✅
- [x] Dropdown menu реализован с Tailwind + Alpine.js ✅
- [ ] Протестировать на разных разрешениях (требуется тестирование):
  - [ ] iPhone SE (375px)
  - [ ] iPad (768px)
  - [ ] Desktop (1024px+)

**Адаптивность**:
```html
<!-- Мобильное меню (скрыто по умолчанию) -->
<div class="md:hidden" x-show="mobileMenuOpen">
  <!-- Навигация для мобильных -->
</div>

<!-- Десктопное меню -->
<nav class="hidden md:flex items-center space-x-[18px]">
  <!-- Навигация для десктопа -->
</nav>
```

---

### 2.3 Sidebar (`templates/includes/_sidebar.html`) ✅
**Текущий статус**: Мигрирован на Tailwind

- [x] Убрано подключение `static/css/sidebar.css` из base.html ✅
- [x] Переписан на Tailwind классы ✅
- [x] Сделан адаптивным ✅:
  - [x] На мобильных (< 1024px): скрыт (`hidden lg:grid`) ✅
  - [x] На десктопе (> 1024px): полная ширина ✅
- [x] Виджеты стекаются вертикально ✅
- [x] Добавлены стили карточек (.support-card, .friends-card) в input.css ✅
- [ ] Добавить анимации при раскрытии/скрытии (TODO)

**CSS для удаления**:
- `static/css/sidebar.css` (стили мигрированы, файл оставлен)

---

### 2.4 Footer (`templates/includes/_footer.html`) ✅
- [x] Переписан на Tailwind ✅
- [x] Сделан адаптивным (центрирование на мобильных, выравнивание слева на десктопе) ✅
- [x] Добавлен responsive padding/margin ✅
- [x] Стили: border-t, border-panel-border, max-w-[1200px], mx-auto, py-[18px], px-4 ✅

---

### 2.5 Upload Modal (`templates/includes/_upload_modal.html`) ✅
**Текущий статус**: Мигрирован на Tailwind, использует Alpine.js

- [x] Базовые стили модального окна в input.css ✅
- [x] Адаптивные размеры модального окна ✅
- [x] Drag-and-drop область стилизована ✅
- [ ] Протестировать на мобильных устройствах (требуется тестирование)
- [ ] Протестировать на touch-устройствах (требуется тестирование)

---

### 2.6 Alert Modal (`templates/includes/_alert_modal.html`) ✅
**Текущий статус**: Мигрирован на Tailwind

- [x] Убрано подключение `static/css/alert_modal.css` из base.html ✅
- [x] Переписан на Tailwind (стили в input.css) ✅
- [x] Сделан адаптивным для мобильных устройств ✅
- [x] Добавлены анимации появления/скрытия ✅
- [x] Стили для alert-сообщений и результатов загрузки ✅
- [x] Кастомный скроллбар для списка ошибок ✅
- [x] Поддержка разных типов сообщений (error, success, info) ✅

**CSS для удаления**:
- `static/css/alert_modal.css` (подключение убрано, файл оставлен)

---

### 2.7 Messages (`templates/includes/_messages.html`) ✅
- [x] Переписан на Tailwind ✅
- [x] Добавлен компонент .message в input.css ✅
- [x] Добавлено responsive позиционирование ✅
- [x] Поддержка всех типов Django сообщений (error, success, info, warning, debug) ✅
- [x] Цветовая индикация через border и background ✅

---

### 2.8 Pagination (`templates/includes/_pagination.html`) ✅
**Текущий статус**: Мигрирован на Tailwind

- [x] Переписан на Tailwind ✅
- [x] Кнопки сделаны адаптивными ✅
- [x] На мобильных: уменьшены размеры кнопок (text-xs px-2 py-1) ✅
- [x] Добавлены hover состояния с анимацией ✅
- [x] Компоненты .page-btn и .page-state в input.css ✅
- [x] Responsive дизайн для мобильных (<640px) ✅

---

## Фаза 3: Миграция страниц реплеев

### 3.1 Список реплеев (`replays/templates/replays/list.html`) ✅
**Текущий статус**: Мигрирован на Tailwind

- [x] Переписать карточки реплеев на Tailwind ✅
- [x] **Адаптивная сетка**: ✅
  - [x] Мобильные (< 480px): вертикальный layout, уменьшенные элементы ✅
  - [x] Планшеты (640px-768px): вертикальный layout ✅
  - [x] Десктоп (> 768px): горизонтальный layout (как раньше) ✅
- [x] Сортировки (`sorters`): ✅
  - [x] Используют существующие компоненты `.btn` и `.btn--ghost` ✅
  - [x] Адаптивная сетка: `grid grid-cols-5 gap-2` ✅
- [x] Карточки реплеев (`.tovabb`): ✅
  - [x] Переписаны на Tailwind (компонент в input.css) ✅
  - [x] Адаптивные размеры изображений ✅
  - [x] Touch-friendly hover эффекты с анимацией ✅
- [x] Статистика в карточках: ✅
  - [x] На мобильных: уменьшены иконки и шрифты ✅
  - [x] На десктопе: оригинальные размеры ✅
- [x] Кнопки "Фильтры"/"Сбросить": ✅
  - [x] Используют `.btn`, `.btn--accent`, `.btn--ghost` ✅
- [x] Закомментировать `static/css/wot_record_skin.css` (сохранен для отката) ✅

**CSS файлы**:
- `static/css/wot_record_skin.css` - все стили закомментированы, файл сохранен

**Пример адаптивной сетки**:
```html
<main class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-1 gap-3">
  <!-- Карточки реплеев -->
</main>
```

---

### 3.2 Детали реплея (`replays/templates/replays/detail.html`)
**Текущий статус**: Использует `replay-detail.css`, сложная структура

⚠️ **ОСОБОЕ ТРЕБОВАНИЕ**: Эта страница должна оставаться фиксированной ширины!

- [ ] Удалить `static/css/replay-detail.css`
- [ ] Переписать на Tailwind
- [ ] **Обернуть весь контент в контейнер фиксированной ширины**:
  ```html
  <div class="min-w-[1003px] max-w-[1003px] mx-auto overflow-x-auto">
    <!-- Весь контент страницы detail -->
  </div>
  ```
- [ ] На мобильных/планшетах: **горизонтальный скролл**
- [ ] Таблицы:
  - [ ] `.team-score` - фиксированная ширина
  - [ ] `.tank-list` - фиксированная ширина
  - [ ] `.hit-list` - фиксированная ширина
- [ ] Табы (`replay-tabs`):
  - [ ] Переписать на Tailwind
  - [ ] Оставить фиксированные размеры
- [ ] Карточки достижений:
  - [ ] Фиксированные размеры
  - [ ] Не адаптировать под мобильные
- [ ] Кнопка "Скачать":
  - [ ] Tailwind классы
  - [ ] Фиксированная позиция
- [ ] Комментарии:
  - [ ] Адаптивная ширина (внутри контейнера)
  - [ ] На мобильных: full-width внутри scroll-контейнера

**CSS для удаления**:
- `static/css/replay-detail.css` (специфичные стили для detail)

**Важно**:
- НЕ делать адаптивными таблицы и статистику
- Сохранить все размеры и пропорции
- Обеспечить горизонтальный скролл на узких экранах

---

### 3.3 Фильтры (`replays/templates/replays/filters.html`) ✅
**Текущий статус**: Мигрирован на Tailwind

- [x] Закомментирован `static/css/replays_filters.css` ✅
- [x] Переписана форма на Tailwind ✅
- [x] **Адаптивная форма**: ✅
  - [x] Мобильные (< 640px): 1 колонка ✅
  - [x] Планшеты (640px-1024px): 2 колонки ✅
  - [x] Десктоп (> 1024px): 3 колонки (как раньше) ✅
- [x] Chips (чекбоксы/радио): ✅
  - [x] Адаптивный размер ✅
  - [x] Touch-friendly (минимум 44px на мобильных) ✅
- [x] Поля ввода: ✅
  - [x] Full-width на мобильных ✅
  - [x] Адаптивные размеры на десктопе ✅
- [x] Кнопки действий: ✅
  - [x] На мобильных: full-width, стек ✅
  - [x] На десктопе: inline, как сейчас ✅
- [x] Списки танков и версий: ✅
  - [x] Адаптивная высота ✅
  - [x] Touch-friendly скролл ✅

**CSS файлы**:
- `static/css/replays_filters.css` - все стили закомментированы, файл сохранен

---

## Фаза 4: Миграция auth страниц

### 4.1 Вход (`templates/account/login.html`)
**Текущий статус**: Частично Tailwind

- [ ] Проверить адаптивность формы
- [ ] OAuth кнопки:
  - [ ] Full-width на мобильных
  - [ ] Адаптивный размер иконок
- [ ] Центрирование карточки
- [ ] Responsive padding

---

### 4.2 Регистрация (`templates/account/signup.html`)
- [ ] Аналогично странице входа
- [ ] Адаптивная форма
- [ ] Валидация полей (визуальная)

---

### 4.3 Восстановление пароля
- [ ] Переписать на Tailwind
- [ ] Адаптивная форма

---

### 4.4 Email подтверждение (`templates/account/email_confirm.html`)
- [ ] Переписать на Tailwind
- [ ] Адаптивная карточка

---

## Фаза 5: Дополнительные страницы

### 5.1 О проекте (`templates/about.html`)
- [ ] Переписать на Tailwind
- [ ] Адаптивный текст и изображения
- [ ] Responsive layout

---

### 5.2 Ошибки (404, 500)
- [ ] `templates/404.html` - Tailwind
- [ ] `templates/500.html` - Tailwind
- [ ] Адаптивная центрированная карточка

---

## Фаза 6: Удаление legacy CSS

### 6.1 Удаление файлов
- [ ] Удалить `static/css/site.css`
- [ ] Удалить `static/css/wot_record_skin.css`
- [ ] Удалить `static/css/replay-detail.css`
- [ ] Удалить `static/css/replays_filters.css`
- [ ] Удалить `static/css/sidebar.css`
- [ ] Удалить `static/css/dev_banner.css`
- [ ] Удалить `static/css/alert_modal.css`

### 6.2 Очистка base.html
- [ ] Убрать все `<link>` на custom CSS
- [ ] Оставить только Tailwind CSS
- [ ] Проверить что ничего не сломалось

---

## Фаза 7: Оптимизация и тестирование

### 7.1 Производительность
- [ ] Проверить размер финального CSS файла
- [ ] Настроить PurgeCSS для удаления неиспользуемых классов
- [ ] Минификация CSS для продакшна
- [ ] Gzip сжатие

### 7.2 Кроссбраузерность
- [ ] Chrome/Edge (Desktop)
- [ ] Firefox (Desktop)
- [ ] Safari (Desktop)
- [ ] Chrome Mobile (Android)
- [ ] Safari Mobile (iOS)

### 7.3 Адаптивность
Протестировать на всех breakpoints:
- [ ] iPhone SE (375px)
- [ ] iPhone 12/13 (390px)
- [ ] iPhone 14 Pro Max (430px)
- [ ] iPad Mini (768px)
- [ ] iPad Pro (1024px)
- [ ] Desktop HD (1920px)
- [ ] Desktop 2K (2560px)

### 7.4 Accessibility (A11y)
- [ ] Keyboard navigation
- [ ] Screen reader compatibility
- [ ] Color contrast (WCAG AA)
- [ ] Focus indicators
- [ ] Touch target size (минимум 44x44px)

### 7.5 Функциональное тестирование
- [ ] Загрузка реплеев (все разрешения)
- [ ] Фильтрация и сортировка (мобильные/десктоп)
- [ ] Навигация (мобильное меню)
- [ ] Авторизация (формы на мобильных)
- [ ] Просмотр деталей реплея (горизонтальный скролл)
- [ ] Комментарии (адаптивный ввод)

---

## Фаза 8: Документация и деплой

### 8.1 Документация
- [ ] Обновить `README.md` с инструкциями по сборке CSS
- [ ] Добавить документацию по Tailwind config
- [ ] Описать responsive breakpoints
- [ ] Добавить примеры кастомных компонентов

### 8.2 Деплой
- [ ] Обновить Dockerfile (если нужно)
- [ ] Проверить сборку CSS в CI/CD
- [ ] Деплой на тестовый сервер
- [ ] Проверить на продакшн-домене
- [ ] Откатить при критических багах

---

## Приоритизация

### 🔴 Высокий приоритет (критичные страницы)
1. Base layout + Navbar (Фаза 2.1, 2.2)
2. Список реплеев (Фаза 3.1) - основная страница
3. Детали реплея (Фаза 3.2) - **с особым вниманием к fixed layout**
4. Upload Modal (Фаза 2.5) - основная функция

### 🟡 Средний приоритет
5. Фильтры (Фаза 3.3)
6. Sidebar (Фаза 2.3)
7. Auth страницы (Фаза 4)

### 🟢 Низкий приоритет
8. О проекте (Фаза 5.1)
9. Страницы ошибок (Фаза 5.2)
10. Footer, Messages, Pagination (Фаза 2.4, 2.7, 2.8)

---

## Риски и митигация

### Риск 1: Сломается layout на detail.html
**Митигация**:
- Начать с тестирования fixed-width контейнера
- Создать отдельную ветку для миграции detail
- Тщательное тестирование перед мержем

### Риск 2: Большой размер финального CSS
**Митигация**:
- Настроить PurgeCSS
- Использовать JIT режим Tailwind
- Мониторить размер bundle

### Риск 3: Конфликт с существующими стилями
**Митигация**:
- Постепенная миграция страница за страницей
- Проверка CSS специфичности
- Использование `!important` в крайних случаях

### Риск 4: Проблемы с touch-устройствами
**Митигация**:
- Тестирование на реальных устройствах
- Увеличение размеров tap targets
- Добавление touch feedback

---

## Чек-лист перед каждым коммитом

- [ ] Проверена адаптивность на 3+ разрешениях
- [ ] Нет console ошибок в браузере
- [ ] Все интерактивные элементы работают
- [ ] CSS минифицирован для продакшна
- [ ] Обновлена документация (если нужно)
- [ ] Создан скриншот до/после (для важных изменений)

---

## Метрики успеха

### Производительность
- [ ] Размер CSS < 100KB (минифицированный)
- [ ] Lighthouse Performance Score > 90
- [ ] First Contentful Paint < 1.5s
- [ ] Largest Contentful Paint < 2.5s

### Адаптивность
- [ ] 100% страниц адаптивны (кроме detail)
- [ ] Все элементы читаемы на 375px
- [ ] Нет горизонтального скролла (кроме detail)

### Поддерживаемость
- [ ] 0 кастомных CSS файлов
- [ ] Все стили в Tailwind классах
- [ ] Понятная структура компонентов

---

## Заметки

- **Alpine.js**: Используется для интерактивности (dropdowns, modals). Не трогать!
- **jQuery**: Используется для старого кода. Постепенно мигрировать на Alpine.js.
- **jQuery UI**: Используется для tooltips в detail. Возможно заменить на Alpine.js + Tailwind.
- **Font Awesome**: Иконки. Рассмотреть замену на Heroicons (Tailwind UI).

---

## Полезные ресурсы

- [Tailwind CSS Docs](https://tailwindcss.com/docs)
- [Responsive Design Best Practices](https://web.dev/responsive-web-design-basics/)
- [Tailwind UI Components](https://tailwindui.com/)
- [Alpine.js Docs](https://alpinejs.dev/)
- [Mobile-First CSS](https://developer.mozilla.org/en-US/docs/Web/Progressive_web_apps/Responsive/Mobile_first)

---

## Статус выполнения

**Всего задач**: 150+
**Выполнено**: 58
**В процессе**: 0
**Осталось**: 92+

**Прогресс**: ████████░░ 39%

---

## ✅ Завершенные фазы

### Фаза 1: Инфраструктура ✅
- Tailwind CLI настроен и работает
- `tailwind.config.js` с кастомной палитрой
- `input.css` с директивами @tailwind
- npm scripts для сборки CSS
- Продакшн-версия с минификацией

### Фаза 2: Базовые компоненты ✅ (8/8)
- Base Layout ✅
- Navbar ✅
- Sidebar ✅
- Footer ✅
- Upload Modal ✅
- Alert Modal ✅
- Messages ✅
- Pagination ✅

### Фаза 3: Страницы реплеев (2/3 завершено)
- Список реплеев (list.html) ✅
- Фильтры (filters.html) ✅
- Детали реплея (detail.html) - в ожидании

**Размер output.css**: 60KB (минифицированный, +6KB для filter components)

---

## 🚀 Следующие шаги

### Приоритет 1: Тестирование мигрированных компонентов
- [ ] Протестировать list.html на iPhone SE (375px)
- [ ] Протестировать list.html на iPad (768px)
- [ ] Протестировать list.html на Desktop (1024px+)
- [ ] Проверить hover эффекты карточек реплеев
- [ ] Проверить touch-friendly элементы

### Приоритет 2: Миграция оставшихся страниц реплеев
- [x] Список реплеев (list.html) ✅ - ЗАВЕРШЕНО
- [x] Фильтры (filters.html) ✅ - ЗАВЕРШЕНО
- [ ] Детали реплея (detail.html) - СЛЕДУЮЩИЙ (с особым вниманием - fixed-width)

---

**Дата создания плана**: 2025-10-30
**Последнее обновление**: 2025-10-30 14:15
**Ответственный**: Разработчик проекта lesta_replays
