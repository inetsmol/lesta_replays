@tailwind base;
@tailwind components;
@tailwind utilities;

/* Custom base styles */
@layer base {
  * {
    box-sizing: border-box;
  }

  html, body {
    @apply h-full m-0 p-0;
  }

  body {
    @apply bg-dark-900 text-text font-sans text-xs leading-normal min-h-screen flex flex-col;
  }

  @supports (height: 100svh) {
    body {
      min-height: 100svh;
    }
  }

  a {
    @apply text-inherit no-underline;
  }
}

/* Custom components */
@layer components {
  /* Brand component */
  .brand {
    @apply flex items-center gap-2 font-extrabold tracking-wide no-underline;
  }

  .brand-logo {
    @apply h-8 w-auto object-contain flex-shrink-0;
  }

  .brand-text {
    @apply text-lg font-extrabold tracking-wide;
  }

  @media (max-width: 768px) {
    .brand-logo {
      @apply h-7;
    }

    .brand-text {
      @apply text-base;
    }
  }

  /* Container center - для большинства страниц */
  .container-center {
    @apply max-w-content mx-5;
  }

  /* Container center fixed - для detail страницы */
  .container-center-fixed {
    @apply min-w-content max-w-content mx-auto overflow-x-auto;
  }

  /* Content wrapper */
  #content {
    @apply py-5 pb-7 flex-1 w-full max-w-site mx-auto;
  }

  /* Footer */
  .footer {
    @apply max-w-footer mx-auto;
  }

  /* Sidebar cards */
  .support-card,
  .friends-card {
    @apply bg-dark-700 border border-dark-600 rounded-custom-sm p-3 text-[#e9eef4] text-sm;
  }

  .support-card__title,
  .friends-card__title {
    @apply font-bold text-base mb-2 flex items-center gap-2;
  }

  .friends-card__title--sm {
    @apply text-sm;
  }

  .support-card__text,
  .friends-card__lead {
    @apply leading-normal opacity-95 mb-2.5;
  }

  /* QR блок в донатах */
  .support-qr {
    @apply grid place-items-center bg-white/[0.03] border border-dashed border-white/[0.12] rounded-[10px] p-2.5 mb-2.5;
  }

  .support-qr img {
    @apply w-full max-w-[160px] h-auto rounded-lg;
    image-rendering: crisp-edges;
  }

  .support-mini {
    @apply text-xs opacity-85 mt-1.5 text-center;
  }

  /* Кнопка доната */
  .support-btn {
    @apply inline-flex items-center gap-2 px-3 py-2 rounded-lg border border-white/15
           bg-gradient-to-b from-white/[0.06] to-white/[0.02] no-underline text-[#e9eef4]
           font-semibold transition-all duration-75 select-none hover:-translate-y-px hover:border-white/25;
  }

  .support-note {
    @apply mt-2 text-xs opacity-70;
  }

  /* Друзья: список и элементы */
  .friends-links {
    @apply list-none m-0 p-0 grid gap-2;
  }

  .social-btns {
    @apply flex items-center gap-2.5 px-2.5 py-2.5 no-underline border border-white/10
           rounded-[10px] bg-gradient-to-b from-white/[0.04] to-white/[0.02]
           transition-all duration-75 text-[#e9eef4] hover:-translate-y-px hover:border-white/[0.22];
  }

  .social-icon {
    @apply w-7 h-7 rounded-full object-cover inline-block flex-shrink-0;
  }

  .icon-wrap {
    @apply w-7 h-7 rounded-full inline-grid place-items-center overflow-hidden flex-shrink-0;
  }

  .icon-wrap svg circle {
    fill: rgba(255, 255, 255, 0.12);
  }

  .icon-wrap svg path {
    @apply fill-white opacity-95;
  }

  .social-meta {
    @apply grid leading-tight;
  }

  .social-name {
    @apply font-semibold;
  }

  .social-link {
    @apply text-xs opacity-80;
  }

  /* Big red button */
  .big-red-button {
    width: 152px;
    height: 44px;
    line-height: 42px;
    background: url(../style/images/wot/buttons/red-button-sprite.png);
    border: none;
    border-radius: 4px;
    font-family: "Oswald", sans-serif;
    font-size: 20px;
    color: #F2F2F2;
    text-shadow: 0px 0px 10px black, 0px 0px 10px black, 0px 0px 1px black, 0px 0px 2px black;
  }

  .big-red-button.inactive,
  .big-red-button.inactive:hover {
    background-size: 100% 400%;
    background-position: 0% 200%;
  }

  /* Modal base styles */
  .modal {
    @apply fixed inset-0 z-[1000] flex items-center justify-center p-4 md:p-8;
    @apply opacity-0 invisible transition-all duration-300 ease-in-out;
  }

  .modal[aria-hidden="false"] {
    @apply opacity-100 visible;
  }

  .modal-overlay {
    @apply absolute inset-0 bg-black/70 backdrop-blur-sm;
  }

  .modal-content {
    @apply relative bg-dark-800 border border-dark-600 rounded-xl shadow-2xl;
    @apply w-full max-w-2xl max-h-[90vh] flex flex-col;
    @apply transform scale-95 translate-y-5 transition-transform duration-300;
  }

  .modal[aria-hidden="false"] .modal-content {
    @apply scale-100 translate-y-0;
  }

  .modal-header {
    @apply flex items-center justify-between px-6 py-4 border-b border-dark-600 bg-dark-700;
  }

  .modal-header h2 {
    @apply m-0 text-xl font-bold text-text;
  }

  .modal-close {
    @apply flex items-center justify-center w-8 h-8 rounded-lg;
    @apply bg-transparent border-none text-text/60 cursor-pointer;
    @apply transition-all duration-200 hover:bg-white/10 hover:text-text;
  }

  .modal-body {
    @apply px-6 py-6 flex-1 overflow-y-auto;
  }

  .modal-footer {
    @apply flex items-center justify-end gap-3 px-6 py-4 border-t border-dark-600;
  }

  /* Button styles */
  .btn {
    @apply inline-flex items-center justify-center gap-2 px-4 py-2 rounded-lg;
    @apply bg-dark-700 text-text border border-dark-600;
    @apply font-medium text-sm cursor-pointer select-none;
    @apply transition-all duration-200;
    @apply hover:-translate-y-0.5 hover:shadow-lg;
  }

  .btn--accent {
    @apply bg-gradient-to-br from-accent-500 to-accent-600 border-accent-500/60 text-white;
    @apply shadow-lg shadow-accent-500/30;
    @apply hover:shadow-xl hover:shadow-accent-500/40;
  }

  .btn--ghost {
    @apply bg-transparent text-text-muted border-dark-600;
    @apply hover:bg-dark-700 hover:text-text;
  }

  /* Alert Modal specific styles */
  .alert-modal-content .modal-body {
    @apply max-h-[60vh] overflow-y-auto;
  }

  .alert-message-content {
    @apply text-text-muted leading-relaxed;
  }

  /* Alert summary */
  .alert-summary {
    @apply px-4 py-3 bg-blue-500/10 border-l-4 border-blue-500 rounded-lg mb-4 text-sm;
  }

  .alert-summary.has-errors {
    @apply bg-red-500/10 border-red-500;
  }

  .alert-summary-text {
    @apply m-0 font-medium;
  }

  /* Upload results list */
  .upload-results-list {
    @apply list-none p-0 m-0;
  }

  .upload-result-item {
    @apply px-3 py-3 mb-2 rounded-lg bg-white/[0.03] border border-white/10;
  }

  .upload-result-item.success {
    @apply bg-green-500/10 border-green-500/30;
  }

  .upload-result-item.error {
    @apply bg-red-500/10 border-red-500/30;
  }

  .upload-result-header {
    @apply flex items-center gap-2 mb-1.5;
  }

  .upload-result-icon {
    @apply flex-shrink-0 w-5 h-5 flex items-center justify-center rounded-full;
  }

  .upload-result-item.success .upload-result-icon {
    @apply bg-green-500/20 text-green-500;
  }

  .upload-result-item.error .upload-result-icon {
    @apply bg-red-500/20 text-red-500;
  }

  .upload-result-filename {
    @apply flex-1 font-medium text-sm break-words;
  }

  .upload-result-error {
    @apply m-0 px-3 py-2 bg-black/20 rounded-md text-xs text-red-300 leading-normal;
  }

  /* Simple alert messages */
  .alert-simple-message {
    @apply px-4 py-4 border-l-4 rounded-lg leading-relaxed;
  }

  .alert-simple-message--error {
    @apply bg-red-500/10 border-red-500 text-red-300;
  }

  .alert-simple-message--success {
    @apply bg-green-500/[0.12] border-green-500 text-green-200;
  }

  .alert-simple-message--info {
    @apply bg-blue-500/[0.12] border-blue-500 text-blue-200;
  }

  /* Status icons */
  .status-icon-success::before {
    content: "✓";
  }

  .status-icon-error::before {
    content: "✕";
  }

  /* Custom scrollbar for alert modal */
  .alert-modal-content .modal-body::-webkit-scrollbar {
    @apply w-2;
  }

  .alert-modal-content .modal-body::-webkit-scrollbar-track {
    @apply bg-white/5 rounded;
  }

  .alert-modal-content .modal-body::-webkit-scrollbar-thumb {
    @apply bg-white/20 rounded hover:bg-white/30;
  }

  /* Mobile responsive */
  @media (max-width: 768px) {
    .modal {
      @apply p-2;
    }

    .modal-content {
      @apply max-w-full;
    }

    .modal-header,
    .modal-body,
    .modal-footer {
      @apply px-4;
    }
  }

  /* Site Banner (Dev Banner) */
  .site-banner {
    @apply flex items-center justify-center gap-3 px-3.5 py-2.5 border-b border-black/[0.08] text-[13px];
  }

  .site-banner--dev {
    @apply bg-[#fff6d6] text-[#4a3b00];
  }

  @media (prefers-color-scheme: dark) {
    .site-banner--dev {
      @apply bg-[#3b3420] text-[#ffe9a6] border-b-white/10;
    }
  }

  .site-banner--dev a {
    @apply text-inherit underline;
  }

  .site-banner__inner {
    @apply pr-2;
  }

  .site-banner__close {
    @apply appearance-none border-0 bg-transparent text-[22px] leading-none;
    @apply cursor-pointer text-inherit opacity-60 hover:opacity-100;
  }

  /* Messages (Django messages framework) */
  .message {
    @apply px-3 py-2.5 rounded-lg border border-dark-600 bg-dark-800;
  }

  .message--error {
    @apply border-red-500/30 bg-red-500/10 text-red-300;
  }

  .message--success {
    @apply border-green-500/30 bg-green-500/10 text-green-200;
  }

  .message--info {
    @apply border-blue-500/30 bg-blue-500/10 text-blue-200;
  }

  .message--warning {
    @apply border-yellow-500/30 bg-yellow-500/10 text-yellow-200;
  }

  .message--debug {
    @apply border-gray-500/30 bg-gray-500/10 text-gray-300;
  }

  /* Pagination */
  .page-btn {
    @apply px-2.5 py-1.5 border border-dark-600 rounded-lg bg-dark-800;
    @apply text-text no-underline transition-all duration-200;
    @apply hover:bg-dark-700 hover:border-dark-700 hover:-translate-y-px;
  }

  .page-state {
    @apply text-text-muted text-sm;
  }

  /* Mobile responsive pagination */
  @media (max-width: 640px) {
    .page-btn {
      @apply text-xs px-2 py-1;
    }

    .page-state {
      @apply text-xs;
    }
  }

  /* Replay Grid (List view) */
  .replay-grid {
    @apply flex flex-col gap-3;
  }

  /* Replay Card (tovabb) */
  .tovabb {
    @apply block relative max-w-[1024px] cursor-pointer no-underline;
    @apply bg-gradient-to-br from-slate-700/40 to-slate-800/60;
    @apply border border-slate-500/30 rounded-xl overflow-hidden;
    @apply transition-all duration-300 ease-out;
    @apply shadow-[0_4px_6px_-1px_rgba(0,0,0,0.3),0_2px_4px_-1px_rgba(0,0,0,0.2)];
    animation: fadeIn 0.3s ease-in-out;
  }

  @keyframes fadeIn {
    from {
      opacity: 0;
      transform: translateY(8px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  .tovabb::before {
    content: '';
    @apply absolute inset-0 opacity-0 pointer-events-none z-[1];
    @apply transition-opacity duration-300;
    background: radial-gradient(circle at top right, rgba(139, 92, 246, 0.05) 0%, transparent 50%);
  }

  .tovabb:hover {
    @apply border-purple-500/40;
    @apply shadow-[0_20px_25px_-5px_rgba(0,0,0,0.4),0_10px_10px_-5px_rgba(0,0,0,0.3),0_0_0_1px_rgba(139,92,246,0.1)];
  }

  .tovabb:hover::before {
    @apply opacity-100;
  }

  .tovabb .wrapper {
    @apply flex items-stretch relative z-[2];
  }

  /* Image Container */
  .img-container {
    @apply relative w-60 h-[132px] overflow-hidden flex-shrink-0;
    @apply bg-gradient-to-br from-slate-900 to-slate-800;
  }

  .img-container::after {
    content: '';
    @apply absolute bottom-0 left-0 right-0 h-[60%] z-[2] pointer-events-none;
    background: linear-gradient(180deg, transparent 0%, rgba(0, 0, 0, 0.5) 100%);
  }

  .img-container .map {
    @apply absolute inset-0 w-full h-full object-cover z-[1];
    @apply transition-opacity duration-200;
  }

  .img-container .tank {
    @apply absolute right-1.5 bottom-1.5 h-[90px] w-auto max-w-[135px] object-contain z-[3];
    @apply transition-opacity duration-200;
    filter: drop-shadow(1px 1px 2px rgba(0, 0, 0, 0.7));
  }

  .img-container .map-name {
    @apply absolute left-2.5 top-2 z-[2] inline-block max-w-[135px] px-1.5 py-0.5 rounded;
    @apply text-sm font-semibold uppercase text-gray-600;
    @apply bg-white/10 backdrop-blur-sm;
    font-family: "Oswald", Arial, sans-serif;
    text-shadow: 0 0 2px #fff, 0 0 6px #fff;
  }

  .img-container .name {
    @apply absolute left-2.5 bottom-2.5 z-[2] px-1.5 py-0.5 rounded;
    @apply text-text font-medium bg-black/30 backdrop-blur-sm;
    text-shadow: 0 0 8px rgba(0, 0, 0, 0.8);
  }

  .img-container .name.premium {
    @apply text-gold;
  }

  /* Hide images with no src */
  .img-container .map:not([src]),
  .img-container .tank:not([src]) {
    @apply opacity-0;
  }

  /* Details Section */
  .details {
    @apply flex-1 px-[18px] py-3.5 flex flex-col justify-between min-h-[132px];
    @apply bg-gradient-to-r from-slate-800/20 to-transparent;
  }

  .details .title {
    @apply font-bold text-base mb-1.5 leading-tight text-text;
  }

  .details .upload-info {
    @apply text-xs text-text-muted mb-3;
  }

  .details .table {
    @apply flex flex-wrap gap-1 gap-x-3 text-sm items-center;
    @apply px-2.5 py-1.5 bg-slate-950/40 rounded-lg border border-slate-700/20;
  }

  .details .table .cell {
    @apply flex items-center gap-1 whitespace-nowrap flex-shrink-0;
  }

  .details .table .cell img {
    @apply h-4 w-4 object-contain flex-shrink-0;
  }

  .details .table .cell span {
    @apply text-text font-semibold;
    text-shadow: 0 1px 2px rgba(0, 0, 0, 0.5);
  }

  /* Empty state */
  .empty {
    @apply text-center text-text-muted text-base px-6 py-12;
    @apply bg-dark-700 border border-dark-600 rounded-custom;
  }

  /* Pagination from wot_record_skin.css */
  .pagination {
    @apply mt-6 flex flex-col gap-3;
  }

  .pagination-links {
    @apply flex items-center gap-3 flex-wrap;
  }

  .pagination-link {
    @apply px-3 py-2 border border-dark-600 rounded-custom-sm;
    @apply bg-dark-700 text-text no-underline transition-all duration-200;
    @apply hover:bg-dark-600;
  }

  .current-page {
    @apply px-3 py-2 text-text-muted font-medium;
  }

  .pagination-info {
    @apply text-text-muted text-xs mt-2;
  }

  /* Mobile responsive for replay cards */
  @media (max-width: 768px) {
    .tovabb .wrapper {
      @apply flex-col;
    }

    .img-container {
      @apply w-full h-[150px];
    }

    .img-container .tank {
      @apply h-[100px] max-w-[140px];
    }

    .img-container .map-name {
      @apply text-xs max-w-[120px];
    }

    .details {
      @apply px-3;
    }

    .details .table {
      @apply gap-1.5 gap-x-3 text-xs;
    }

    .details .table .cell img {
      @apply h-4 w-4;
    }
  }

  @media (max-width: 480px) {
    .img-container {
      @apply h-[120px];
    }

    .img-container .tank {
      @apply h-20 max-w-[100px];
    }

    .img-container .map-name,
    .img-container .name {
      @apply text-[10px] px-1 py-0.5 max-w-[100px];
    }

    .details {
      @apply px-2;
    }

    .details .title {
      @apply text-sm;
    }

    .details .table {
      @apply gap-1 gap-x-2 text-[11px];
    }
  }

  /* ==============================================
     Filters Page Components (replays_filters.css)
     ============================================== */

  /* Card component for filters page */
  .card {
    @apply bg-dark-800 border border-dark-600 rounded-custom p-5;
  }

  /* Filter header container */
  .filter-container {
    @apply flex justify-between items-start gap-4 mb-5 flex-wrap;
  }

  .filter-container h1 {
    @apply m-0 text-2xl font-bold text-text;
  }

  .filter-container .actions {
    @apply flex gap-2.5 flex-wrap;
  }

  /* Form layout */
  .form {
    display: grid;
    @apply gap-4;
  }

  .form-row {
    display: grid;
    @apply gap-4;
  }

  /* Responsive grid layouts */
  .form-row.grid-2 {
    @apply grid-cols-1 sm:grid-cols-2;
  }

  .form-row.grid-3 {
    @apply grid-cols-1 sm:grid-cols-2 lg:grid-cols-3;
  }

  .form-row.grid-4 {
    @apply grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4;
  }

  /* Field styling */
  .field {
    @apply bg-dark-700 border border-dark-600 rounded-custom-sm p-3;
  }

  .field label {
    @apply block mb-2 text-sm font-medium text-text;
  }

  .field input[type="text"],
  .field input[type="search"],
  .field input[type="date"],
  .field input[type="number"] {
    @apply w-full px-3 py-2 bg-dark-900 border border-dark-600 rounded-lg;
    @apply text-text text-sm;
    @apply focus:outline-none focus:border-accent-500/60 focus:ring-1 focus:ring-accent-500/30;
    @apply transition-all duration-200;
  }

  .field input::placeholder {
    @apply text-text-muted opacity-70;
  }

  /* Chips (checkboxes and radio buttons) */
  .chips {
    @apply flex flex-wrap gap-2;
  }

  .chip {
    @apply inline-flex items-center gap-1.5 px-2.5 py-1.5 rounded-full;
    @apply border border-dark-600 bg-dark-900;
    @apply cursor-pointer select-none transition-all duration-150;
    @apply hover:bg-dark-700;
  }

  /* Touch-friendly chips on mobile */
  @media (max-width: 768px) {
    .chip {
      @apply min-h-[44px] min-w-[44px] justify-center;
    }
  }

  .chip input {
    @apply hidden;
  }

  /* Checked state for chips */
  .chip:has(input:checked) {
    @apply bg-gradient-to-b from-white/[0.18] to-white/[0.14];
    @apply border-slate-600;
    @apply shadow-[inset_0_0_0_1px_rgba(176,176,176,0.35)];
  }

  /* Lists (tanks, versions) */
  .filter-list {
    @apply max-h-80 overflow-auto border border-dashed border-dark-600 rounded-lg;
    @apply bg-dark-900 p-2;
  }

  .filter-list-item {
    @apply block px-2 py-1.5 rounded-lg cursor-pointer text-xs;
    @apply transition-all duration-150;
    @apply hover:bg-dark-700;
  }

  .filter-list-item input[type="checkbox"] {
    @apply mr-2;
  }

  /* Custom scrollbar for filter lists */
  .filter-list::-webkit-scrollbar {
    @apply w-2;
  }

  .filter-list::-webkit-scrollbar-track {
    @apply bg-white/5 rounded;
  }

  .filter-list::-webkit-scrollbar-thumb {
    @apply bg-white/20 rounded hover:bg-white/30;
  }

  /* Helper text */
  .text-muted-sm {
    @apply text-xs text-text-muted opacity-80;
  }

  /* Divider */
  .form hr {
    @apply my-8 border-0 border-t border-dark-600;
  }

  /* Grid helper for number inputs */
  .field .grid.grid-2 {
    display: grid;
    @apply grid-cols-2 gap-2;
  }

  /* Mobile adjustments for filters page */
  @media (max-width: 640px) {
    .filter-container {
      @apply flex-col items-stretch;
    }

    .filter-container .actions {
      @apply flex-col w-full;
    }

    .filter-container .actions .btn {
      @apply w-full justify-center;
    }

    .card {
      @apply p-4;
    }

    .filter-container h1 {
      @apply text-xl;
    }

    .chips {
      @apply gap-1.5;
    }

    .chip {
      @apply text-[11px] px-2 py-1.5;
    }

    .filter-list {
      @apply max-h-60;
    }

    .filter-list-item {
      @apply px-1.5 py-1 text-[11px];
    }
  }
}

/* Custom utilities */
@layer utilities {
  .shadow-custom {
    box-shadow: 0 6px 18px rgba(0, 0, 0, .35);
  }
}
